<html>
<body>
<h1>Axis C++ windows user guide</h1>

<h2>Creating And Deploying your own Web Service</h2>
<p>
<a href="#create">Creating the web service</a><br>
<a href="#wsdl2ws">How to use the WSDL2WS tool on the command line</a><br>
<a href="#deploy">Deploying your web service</a><br>
<a href="#client">Writing the client</a><br>
<a href="#sample">Running your sample</a><br>
<br>
<b>Before you follow this guide, make sure that you have followed the</b>
<a href="wininstall-guide.html"><b>Windows Installation guide</b></a>
</p>

<p><a name="create"></a></p>
<h2>Creating the web service</h2><br>
<p>
Currently axis supports two methods to create and deploy a Web Service. 
<br>
Method 1) A top down approach where you start with a WSDL.
<br>
Method 2) A bottom up apporach where you start with a pre-written web service.

<br>
<br>
Here we discuss the first apporach since the tool to support Method 2 (i.e wcg.exe) is still at its primitive stage in this Alpaha Release.

<br>
Here the document is written with the idea that the user uses Visual C++ (VC). But user could use this guide with a different IDE of his choice.

<br>
<br>
<b>Method 1</b> <br>

This method assums that the user has written the wsdl of the service which he needs to deploy. In this methods user will start with this wsdl and the tool will generate the web service skeleton and other required files.

<br>
1) Get your wsdl (eg:<a href="../cfiles/Calculator.wsdl">Calculator.wsdl</a>)
<br>
2) Run the WSDL2WS tool (refer the section below 'How to use the WSDL2WS tool on the command line') and generate the server side skeletons and wrappers. These files will be in two new folder which are gentrated from the tool called 'ServerOut' and 'ClientOut'.
<br>
3) Create a VC workspace.
<br>
4) Create a 'Win32 Static Library' project in this workspace.
<br>
5) Add the following files to this project, from the generated 'ServerOut' folder.
	Calculator.cpp
	Calculator.h <br>
6) Set the include path to the include directory of the binary distribution (These include files are in AXIS_EXTRACT/include/).
<br>
7) Fill the empty methods of the generated skelitons. Here the idea is 
<br>
8) Generate the lib (eg: MyCalculator.lib)
<br>
9) Now create a 'Win32 Dynamic-Link Library' project.
<br>
10) Add the following files to this project, from the generated 'ServerOut' folder.
	CalculatorService.cpp
	CalculatorWrapper.cpp
	CalculatorWrapper.h <br>
11) Set the include path to the include directory of the binary distribution.
<br>
12) Add the above created lib (Calculator.lib) to the library modules of this project.
<br>
13) Build and create the DLL. (Calculator.dll)
</p>
<p><a name="wsdl2ws"></a></p>
<h2>How to use the WSDL2WS tool on the command line</h2><br>
<p>
For using WSDL2Ws java tool on the command line you require jdk1.4 or above.

<br>
<br>
To use WSDL2Ws java tool you should set the CLASSPATH Environment Variable to point to the following jar files in AXIS_EXTRACT\lib\axisjava.

<br>
<br>
axis.jar <br>
commons-discovery.jar <br>
commons-logging.jar <br>
jaxrpc.jar <br>
saaj.jar <br>
wsdl4j.jar
<br>
xml-apis.jar <br>
<br>

The CLASSPATH Environment Variabe should have the absolute paths of the jars (including the jar file name) given as a semicolon separated list.

<br>
<br>
Open a command window.

Change directory to AXIS_EXTRACT\lib\axis. We will call this folder as WSDL2WS_FOLDER.

<br>
<br>
Now copy the wsdl file (eg.Calculator.wsdl) which you use to the folder WSDL2WS_FOLDER.

<br>
<br>
Now run the following command to generate the server side skeletons and wrappers.

<br>
<br>
Java -classpath %classpath%;.\wsdl2ws.jar org.apache.axis.wsdl.wsdl2ws.WSDL2Ws Calculator.wsdl -o./ServerOut -lc++ -sserver
<br>
<br>

If the tools is successful the tool will display the files the it has generated. The skeletons and 
wrappers will be generated in [WSDL2WS_FOLDER]\ServerOut.

<br>
<br>
Run the following command to generate the client stubs.

<br>
<br>
Java -classpath %classpath%;.\wsdl2ws.jar org.apache.axis.wsdl.wsdl2ws.WSDL2Ws Calculator.wsdl -o./ClientOut -lc++ -sclient
<br>
<br>

The generated client stubs will be in [WSDL2WS_FOLDER]\ClientOut
</p>
<p><a name="deploy"></a></p>
<h2>Deploying your web service</h2><br>
<p>
Currently the AdminClient tool is having some known bugs. So this section shows you how to deploy your Web Service manually, without using the AdminClient tool.

<br>
1) Copy the above Calculator.dll to the folder APACHE_FOLDER/Axis/webservices.
<br>
2) Go and add the following in the server.wsdd at the service level. Make sure you add these line at the correct place, i.e at service level. (APACHE_FOLDER/Axis/conf/server.wsdd)

<br>
<br>
&lt;service name=&quot;Calculator&quot; provider=&quot;C:RPC&quot; description=&quot;Calculator Web 
Service&quot;&gt;<br>
&lt;parameter name=&quot;className&quot; value=&quot;Axis\webservices\Calculator.dll&quot;/&gt;<br>
&lt;parameter name=&quot;allowedMethods&quot; value=&quot;add subtract &quot;/&gt;<br>
&lt;/service&gt; <br>
<br>
SUCCESS ! Now you have deployed your web service
</p>
<p><a name="client"></a></p>
<h2>Writing the client</h2><br>
<p>
With the WSDL2WS tool you have almost developed your client. What you have to do next is write a file which has a main method and create a object of the stub and invoke your methods on that.

<br>
1) Create a vc workspace.
<br>
2) Create a 'Win32 Console Application'.
<br>
3) Add files to this project from the above generated 'ClientOut' folder.
<br>
4) Set the include path to the include directory of the binary distribution.
<br>
5) Add the following libs to the library modules path of this project.
<br>
<br>
AXIS_EXTRACT/lib/axis/
		<br>
client.lib <br>
		Common.lib <br>
		engine.lib <br>
		Soap.lib <br>
		WSDD.lib <br>
		XML.lib <br>
<br>

	AXIS_EXTRACT/lib/xerces-c
		<br>
xerces-c_2.lib 

	<br>
wsock32.lib
<br>
6) Create a file with the main method which looks similar to the following and add this file to this project.
<br>
</p>
<pre>
#include "Calculator.h"
int main()
{ 
	Calculator c; 
	int result = c.add(40, 20);
	printf("result = %d", result);
	return 0;
}
</pre>
<p>
7) Now build and create the Client.exe
</p>

<p><a name="sample"></a></p>
<h2>Running your sample</h2>
<p>
1) Restart Apache.
<br>
2) Run the Client.exe <br>
<br>

SUCCESS ! If you get the result, you are done.
</p>
</body>
</html>