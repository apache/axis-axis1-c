<project name="Apache Axis C Trace Tool" default="" basedir="..">
	<!--
	  Compile the Trace tool
	  -->
	<target name="compileTraceTool" depends="initialize">
		<mkdir dir="${dir.classes}"/>
		<javac srcdir="${dir.tools}/trace" destdir="${dir.classes}"/>
	</target>
	
	<!--
	  Package Trace tool code into tracetool.jar
	  -->
	<target name="buildTraceTool" depends="compileTraceTool">
		<jar jarfile="${dir.classes}/tracetool.jar" basedir="${dir.classes}">
			<include name="org/apache/axis/tracetool/**"/>
			<manifest>
				<attribute name="Main-Class"
				 value="org.apache.axis.tracetool.AddEntryAndExitTrace"/>
			</manifest>
		</jar>
	</target>
	
	<target name="copyUntracedSource">
		<copy todir="${dir.src.instrumented}">
			<fileset dir="${dir.src}">
				<include name="**"/>
			</fileset>
		</copy>
	</target>

	<target name="runTraceTool" depends="copyUntracedSource">
		<java jar="${dir.classes}/tracetool.jar" fork="true">
			<arg value="${dir.src.instrumented}"/>
		</java>
      </target>

	<!--
	  Compile, package and run the trace tool
	  -->
	<target name="addTrace" depends="buildTraceTool, runTraceTool"
	  description="Compile, jar and run the trace tool"/>

</project>