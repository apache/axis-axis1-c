<project name="Axis C Transport" default="compileAxisTransport" basedir="..">

   <!--
    Compile the Axis Transport Library
    -->
   <target name="compileAxisTransport">
      <mkdir dir="${dir.objects}"/>
      <mkdir dir="${dir.bin}"/>
      <if>
         <not>
            <isset property="aix"/>
         </not>
         <then>
				<!--  Check to see if we are in debug mode so need _D library name -->
				<if>
					<and>
						<isset property="windows"/>
						<equals arg1="${debug}" arg2="true"/>
					</and>
					<then>
						<property name="completeTransportLibraryName" value="${transportLibraryName}_D"/>
					</then>
					<else>
						<property name="completeTransportLibraryName" value="${transportLibraryName}"/>
					</else>
				</if>

            <cc outfile="${dir.bin}/${completeTransportLibraryName}" objdir="${dir.objects}"
             exceptions="true" outtype="shared" multithreaded="true">
               <!-- Compilers -->
               <compiler refid="SolarisCC"/>
               <compiler refid="Linuxgcc"/>
               <compiler extends="VisualC++">
                  <defineset>
                     <define name="AXISTRANSPORTDLL_EXPORTS"/>
                  </defineset>
               </compiler>
                              <compiler refid="OS400icc"/>
               <!-- Linkers -->
               <linker refid="SolarisLinker"/>
               <linker refid="LinuxLinker"/>
               <linker extends="VisualC++Linker">
                  <syslibset libs="wsock32"/>
               </linker>
                              <linker refid="OS400Linker"/>
               <!-- Files to compile -->
               <fileset dir="${dir.src}">
                  <include name="transport/${transport}/*.cpp"/>
                  <include name="platforms/os400/PlatformSpecificOS400.cpp" if="os400"/>
               </fileset>
            </cc>
         </then>
         <else>
            <cc outfile="${dir.bin}/${libraryPrefix}${transportLibraryName}${librarySuffix}" objdir="${dir.objects}"
             exceptions="true" multithreaded="true">
               <!-- Compilers -->
               <compiler refid="AIXxlc"/>
               <!-- Linkers -->
               <linker refid="AIXLinker"/>
               <!-- Files to compile -->
               <fileset dir="${dir.src}">
                  <include name="transport/${transport}/*.cpp"/>
               </fileset>
            </cc>
         </else>
      </if>
   </target>
</project>
